<!DOCTYPE html>
<html
  class=""
  lang="en-au"
  prefix="og: http://ogp.me/ns# fb: http://ogp.me/ns/fb#"
>
  <head>
    <meta charset="utf-8" />

    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
<meta name="description" content="" />
<meta name="HandheldFriendly" content="True" />
<meta name="MobileOptimized" content="320" />
<meta name="viewport" content="width=device-width, initial-scale=1" />


<meta name="keywords" content="">


<meta property="og:type" content="article" />
<meta property="og:description" content="" />
<meta property="og:title" content="apple watch PAM" />
<meta property="og:site_name" content="tdonovic" />
<meta property="og:image" content="" />
<meta property="og:image:type" content="image/jpeg" />
<meta property="og:image:width" content="" />
<meta property="og:image:height" content="" />
<meta property="og:url" content="https://tdonovic.github.io/post/apple-watch-pam/" />
<meta property="og:locale" content="en-au" />
<meta property="article:published_time" content="2020-12-15
" /> <meta property="article:modified_time" content="2020-12-15
" />




<meta name="twitter:card" content="summary" />
<meta name="twitter:site" content="@siegerts" />
<meta name="twitter:creator" content="@siegerts" />
<meta
  name="twitter:title"
  content="apple watch PAM | tdonovic"
/>
<meta
  name="twitter:description"
  content="I noticed the ~weirdest~ coolest thing when using an older (non-touch id) mac with my Apple Watch. When I had to authenticate to, for example, allow sshfs to run, I got prompted to double tap the button on my Apple Watch, in much the same manner as if you are authenticating to use it for Apple Pay. This then unlocked the gear icon thing, and I could run sshfs.
This got my thinking, however, is there some way to make it when I run sudo that I just get a watch prompt instead?|"
/>
<meta name="twitter:image:src" content="" />
<meta name="twitter:domain" content="https://tdonovic.github.io/post/apple-watch-pam/" />



    <title>apple watch PAM</title>
    <link rel="canonical" href="https://tdonovic.github.io/post/apple-watch-pam/" />


    <link
  rel="stylesheet"
  href="https://unpkg.com/tachyons@4.11.1/css/tachyons.min.css"
/>

<link rel="stylesheet" href="https://tdonovic.github.io/css/style.css" />

<link
  rel="stylesheet"
  href="https://cdn.jsdelivr.net/npm/highlightjs@9.12.0/styles/github-gist.css"
/>


<script type="application/javascript">
var dnt = (navigator.doNotTrack || window.doNotTrack || navigator.msDoNotTrack);
var doNotTrack = (dnt == "1" || dnt == "yes");
if (!doNotTrack) {
	window.ga=window.ga||function(){(ga.q=ga.q||[]).push(arguments)};ga.l=+new Date;
	if (window.sessionStorage) {
		var GA_SESSION_STORAGE_KEY = 'ga:clientId';
		ga('create', 'UA-XXXXXXXXX-X', {
	    'storage': 'none',
	    'clientId': sessionStorage.getItem(GA_SESSION_STORAGE_KEY)
	   });
	   ga(function(tracker) {
	    sessionStorage.setItem(GA_SESSION_STORAGE_KEY, tracker.get('clientId'));
	   });
   }
	ga('set', 'anonymizeIp', true);
	ga('send', 'pageview');
}
</script>
<script async src='https://www.google-analytics.com/analytics.js'></script>


    <link rel="shortcut icon" href="/favicon.ico" type="image/x-icon" />
    <link rel="apple-touch-icon" href="/apple-touch-icon.png" />
  </head>


<body
  lang="en-au"
  class="sans-serif w-90 w-80-m w-60-ns center mv2 mv5-ns"
  itemscope
  itemtype="http://schema.org/Article"
>
  
  <span class="b">/ </span>
  <a href="https://tdonovic.github.io/" class="b bb bw1 pb1 no-underline black">tdonovic</a>
  <span class="b"> / </span>
  <a href="/post" class="b bb bw1 pb1 no-underline black">blog</a>

  <section id="main" class="mt5">
    <h1 itemprop="name" id="title">apple watch PAM</h1>
    <span class="f6 gray">December 15, 2020</span>

      <article itemprop="articleBody" id="content" class="w-90 lh-copy">
        <p>I noticed the ~weirdest~ coolest thing when using an older (non-touch id) mac with my Apple Watch. When I had to authenticate to, for example, allow <code>sshfs</code> to run, I got prompted to double tap the button on my Apple Watch, in much the same manner as if you are authenticating to use it for Apple Pay. This then unlocked the gear icon thing, and I could run <code>sshfs</code>.</p>
<p><img src="watch_prompt.png#center" alt="watch prompt"></p>
<p>This got my thinking, however, is there some way to make it when I run <code>sudo</code> that I just get a watch prompt instead? Could you do this with TouchID if your mac supported it? The answer?</p>
<p>Of course you can! With PAM!</p>
<h2 id="what-is-pam">What is PAM?</h2>
<p>PAM (Pluggable Authentication Modules) are a means of proving your identity to the system, other than putting in a boring password. PAM can be used, for example to unlock your computer with a YubiKey. In our case, we are going to exploit PAM to authenticate <code>sudo</code> instead.</p>
<h2 id="pam-watchid">pam-watchid</h2>
<p>Thanks to <a href="https://github.com/biscuitehh/pam-watchid">biscutehh&rsquo;s pam-watchid</a> project, a fork from <a href="https://github.com/Reflejo/pam-touchID">Reflejo&rsquo;s pam-touchID</a>, all you need to do is clone the repo, <code>make install</code> and modify your <code>/etc/pam.d/sudo</code> file. Then you can use Watch to sudo! I presume this will also work with TouchID with the other project, although I was unable to test, since my Mac is too old.</p>

      </article>

      
      <span class="f6 gray mv3" title="Lastmod: December 15, 2020. Published at: 2020-12-15.">
        
      </span>

      

  </section>

  <footer>
    <div>
      <p class="f6 gray mt6 lh-copy">
        Â© 2020 tomas donovic
      </p>
    </div>
  </footer>
  
  <script src="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.14.2/highlight.min.js"></script>

<script>
  hljs.initHighlightingOnLoad();
</script>



  </body>
</html>
